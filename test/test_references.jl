# This file writes or reads the reference test cases.

ref = ["write", "read"][1]

if ref == "write"
    ϕ_ref = Dict()
    h_ref = Dict()
    for test_case in ["A1", "A2", "A3", "A4", "A5", "A6",
                      "D1", "D2", "D3", "D4", "D5"]
        inputs, outputs = run_SHMIP(test_case, Nx=64, Ny=32, dt = 5e7, tsteps=1,
                                   γ_ϕ= 0.8, γ_h=0.9, dτ_ϕ_=1.0, dτ_h_= 7e-6,
                                   printtime=1, printit=1000, make_plot=false);
        ϕ_ref[test_case] =>  repr(outputs.ϕ[1:20:end, 1:10:end])
        h_ref[test_case] =>  repr(outputs.h[1:20:end, 1:10:end])
    end

    # save the reference ϕ and h dictionaries in a file
    save("phi_reference.jld2", "data", ϕ_ref)
    save("h_reference.jld2", "data", h_ref)

elseif ref == "read"
    using JLD2, FileIO
    ϕ_ref = load("phi_reference.jld2")["data"]
    h_ref = load("h_reference.jld2")["data"]
end







ϕ_ref = Dict(# A suite
            "A1"   =>  [100.0 100.0 100.0 100.0;
                        100.0 2.2249409195954804e6 2.2249409195954804e6 2.2249409195954804e6;
                        100.0 5.3627329851798e6 5.3627329851798e6 5.3627329851798e6;
                        100.0 6.843716184432282e6 6.843716184432282e6 6.843716184432282e6],
            "A2"   =>  [100.0 100.0 100.0 100.0;
                        100.0 3.1100655172300003e6 3.1100655172300003e6 3.1100655172300003e6;
                        100.0 6.328689925780037e6 6.328689925780037e6 6.328689925780037e6;
                        100.0 7.953493278862018e6 7.953493278862018e6 7.953493278862018e6],
            "A3"   =>  [100.0 100.0 100.0 100.0;
                        100.0 3.8519410298218653e6 3.8519410298218653e6 3.8519410298218653e6;
                        100.0 7.116877156068533e6 7.116877156068533e6 7.116877156068533e6;
                        100.0 8.869189333956072e6 8.869189333956072e6 8.869189333956072e6],
            "A4"   =>  [100.0 100.0 100.0 100.0;
                        100.0 4.772596538524183e6 4.772596538524183e6 4.772596538524183e6;
                        100.0 8.024489982132435e6 8.024489982132435e6 8.024489982132435e6;
                        100.0 9.868490535286916e6 9.868490535286916e6 9.868490535286916e6],
            "A5"   =>  [100.0 100.0 100.0 100.0;
                        100.0 5.915720511397022e6 5.915720511397022e6 5.915720511397022e6;
                        100.0 8.597198677911505e6 8.597198677911505e6 8.597198677911505e6;
                        100.0 1.02518735522207e7 1.02518735522207e7 1.02518735522207e7],
            "A6"   =>  [100.0 100.0 100.0 100.0;
                        100.0 6.251828874127248e6 6.251828874127248e6 6.251828874127248e6;
                        100.0 9.778510937415462e6 9.778510937415462e6 9.778510937415462e6;
                        100.0 1.2473431549162682e7 1.2473431549162682e7 1.2473431549162682e7],

            # D suite
            "D1"   =>  [100.0 100.0 100.0 100.0;
                        100.0 2.2249409195954804e6 2.2249409195954804e6 2.2249409195954804e6;
                        100.0 5.3627329851798e6 5.3627329851798e6 5.3627329851798e6;
                        100.0 6.843716184432282e6 6.843716184432282e6 6.843716184432282e6],
            "D2"   =>  [100.0 100.0 100.0 100.0;
                        100.0 2.2249409195954804e6 2.2249409195954804e6 2.2249409195954804e6;
                        100.0 5.3627329851798e6 5.3627329851798e6 5.3627329851798e6;
                        100.0 6.843716184432282e6 6.843716184432282e6 6.843716184432282e6],
            "D3"   =>  [],
            "D4"   =>  [],
            "D5"   =>  []
                         )

h_ref = Dict(# A suite
            "A1"   =>  [0.0 0.0 0.0 0.0;
                        0.0 0.004158144787740033 0.004158144787740033 0.004158144787740033;
                        0.0 0.0030838793426752557 0.0030838793426752557 0.0030838793426752557;
                        0.0 0.0013739263281982638 0.0013739263281982638 0.0013739263281982638],
            "A2"   =>  [0.0 0.0 0.0 0.0;
                        0.0 0.009165944915350603 0.009165944915350603 0.009165944915350603;
                        0.0 0.006795181937513707 0.006795181937513707 0.006795181937513707;
                        0.0 0.0027554564793688618 0.0027554564793688618 0.0027554564793688618],
            "A3"   =>  [0.0 0.0 0.0 0.0;
                        0.0 0.02072771152246394 0.02072771152246394 0.02072771152246394;
                        0.0 0.015220625253901044 0.015220625253901044 0.015220625253901044;
                        0.0 0.005639801583888861 0.005639801583888861 0.005639801583888861],
            "A4"   =>  [0.0 0.0 0.0 0.0;
                        0.0 0.06236446343629375 0.06236446343629375 0.06236446343629375;
                        0.0 0.04559895771110403 0.04559895771110403 0.04559895771110403;
                        0.0 0.015278179314757624 0.015278179314757624 0.015278179314757624],
            "A5"   =>  [0.0 0.0 0.0 0.0;
                        0.0 0.09772215416711585 0.09772215416711585 0.09772215416711585;
                        0.0 0.08054934246565632 0.08054934246565632 0.08054934246565632;
                        0.0 0.024000502332472213 0.024000502332472213 0.024000502332472213],
            "A6"   =>  [0.0 0.0 0.0 0.0;
                        0.0 0.7535929349795238 0.7535929349795238 0.7535929349795238;
                        0.0 0.5247815402979188 0.5247815402979188 0.5247815402979188;
                        0.0 0.10540528293138259 0.10540528293138259 0.10540528293138259],

            # D suite
            "D1"   =>  [0.0 0.0 0.0 0.0;
                        0.0 0.004158144787740033 0.004158144787740033 0.004158144787740033;
                        0.0 0.0030838793426752557 0.0030838793426752557 0.0030838793426752557;
                        0.0 0.0013739263281982638 0.0013739263281982638 0.0013739263281982638],
            "D2"   =>  [100.0 100.0 100.0 100.0;
                        100.0 2.2249409195954804e6 2.2249409195954804e6 2.2249409195954804e6;
                        100.0 5.3627329851798e6 5.3627329851798e6 5.3627329851798e6;
                        100.0 6.843716184432282e6 6.843716184432282e6 6.843716184432282e6],
            "D3"   =>  [],
            "D4"   =>  [],
            "D5"   =>  [])
